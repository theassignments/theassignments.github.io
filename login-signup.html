 <!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Signup / Login — TheAssignment</title>

  <style>
    :root{ --accent:#2b8aef; --muted:#6b7280; }

    body{
      margin:0;
      font-family:Inter,Arial,system-ui;
      background:#f3f7fb;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh;
      padding:20px;
    }

    .box{
      width:420px;
      background:#fff;
      border-radius:12px;
      padding:32px;
      box-shadow:0 12px 40px rgba(10,20,40,0.06);
    }

    h2{ margin-top:0; }
    input, textarea {
      width:100%;
      padding:10px;
      margin-top:8px;
      border-radius:8px;
      border:1px solid #e6eef8;
      font-size:14px;
      box-sizing:border-box;
    }

    .btn{
      background:var(--accent);
      color:#fff;
      padding:10px;
      border-radius:8px;
      border:none;
      cursor:pointer;
      margin-top:12px;
      width:100%;
      font-weight:600;
      font-size:15px;
    }

    .muted{ color:var(--muted); font-size:13px; margin-top:8px; }
    .link{ color:var(--accent); cursor:pointer; }

    /* HIDE LOGIN PANEL BY DEFAULT */
    #loginPanel { display:none; }
  </style>
</head>

<body>

  <div class="box">

    <!-- SIGNUP PANEL -->
    <div id="signupPanel">
      <h2>Create Account</h2>
      <p class="muted">Signup with email and password.</p>

      <input id="name" placeholder="Full name" />
      <input id="email" placeholder="Email" />
      <input id="phone" placeholder="Phone (optional)" />
      <input id="password" type="password" placeholder="Password (min 6 chars)" />
      <textarea id="address" rows="3" placeholder="Address (optional)"></textarea>

      <button class="btn" onclick="handleSignup()">Create Account</button>

      <p class="muted">
        Already have an account?
        <span class="link" onclick="showLogin()">Login</span>
      </p>

      <p id="signupMsg" class="muted"></p>
    </div>

    <!-- LOGIN PANEL -->
    <div id="loginPanel">
      <h2>Login</h2>
      <p class="muted">Login using your email and password.</p>

      <form onsubmit="handleLogin(event)">
        <input id="loginEmail" placeholder="Email" required />
        <input id="loginPass" type="password" placeholder="Password" required />
        <button class="btn" type="submit">Sign In</button>
      </form>

      <p id="loginMsg" class="muted"></p>

      <p class="muted">
        Don’t have account?
        <span class="link" onclick="showSignup()">Create account</span>
      </p>
    </div>

  </div>

  <!-- Firebase SDK v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

  <script>
    // Firebase Config (Corrected)
    const firebaseConfig = {
      apiKey: "AIzaSyAwRT7JwLOXgpaA2qCfGKr2b6-yugEFryY",
      authDomain: "theassignments-2a79c.firebaseapp.com",
      projectId: "theassignments-2a79c",
      storageBucket: "theassignments-2a79c.appspot.com",
      messagingSenderId: "32847781306",
      appId: "1:32847781306:web:875c3579275afa00e49183",
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    /* ---------- PANEL TOGGLING ----------- */

    function showLogin(){
      document.getElementById('signupPanel').style.display = "none";
      document.getElementById('loginPanel').style.display = "block";
    }

    function showSignup(){
      document.getElementById('loginPanel').style.display = "none";
      document.getElementById('signupPanel').style.display = "block";
    }

    /* --------------- SIGNUP -------------- */
    async function handleSignup(){
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const password = document.getElementById('password').value;
      const address = document.getElementById('address').value.trim();

      const msg = document.getElementById('signupMsg');
      msg.innerText = "";

      if(!name || !email || password.length < 6){
        msg.innerText = "Name, email and 6+ char password required.";
        return;
      }

      try{
        const userCred = await auth.createUserWithEmailAndPassword(email, password);
        const uid = userCred.user.uid;

        await db.collection('users').doc(uid).set({
          name, email, phone, address,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        msg.innerText = "Signup successful! Redirecting...";
        setTimeout(()=> location.href = "submit.html", 800);

      }catch(err){
        msg.innerText = "Error: " + err.message;
      }
    }

    /* --------------- LOGIN -------------- */
    async function handleLogin(e){
      e.preventDefault();

      const email = document.getElementById('loginEmail').value.trim();
      const pw = document.getElementById('loginPass').value;

      const msg = document.getElementById('loginMsg');
      msg.innerText = "";

      try{
        await auth.signInWithEmailAndPassword(email, pw);
        msg.innerText = "Login successful! Redirecting...";
        setTimeout(()=> location.href="submit.html", 700);

      }catch(err){
        msg.innerText = "Error: " + err.message;
      }
    }
  </script>

</body>
</html>
